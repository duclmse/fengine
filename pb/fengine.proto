syntax = "proto3";

package viot;

service FEngineExecutor {
  rpc Execute(Script) returns (Result) {}
}

service FEngineThing {
  rpc ResolveService(ScriptRequest) returns (Script) {}
}

service FEngineData {
  rpc Select(SelectRequest) returns (Script) {}
  rpc Insert(InsertRequest) returns (Script) {}
  rpc Update(UpdateRequest) returns (Script) {}
  rpc Delete(DeleteRequest) returns (Script) {}
}


//#endregion FEngineExecutor
message Script {
  Function function = 1;
  repeated Variable attributes = 2;
  map<string, Function> referee = 3;
}

message Function {
  repeated Variable input = 1;
  repeated Variable output = 2;

  string code = 3;
}

message Result {
  Variable output = 1;
  UpdateScript update = 2;
  repeated Variable attributes = 3;
}

message UpdateScript {

}

message Variable {
  string name = 1;

  oneof value {
    int32  i32 = 2;
    int64  i64 = 3;
    float  f32 = 4;
    double f64 = 5;
    bool   bool = 6;
    string json = 7;
    string string = 8;
    bytes  binary = 9;
  }
}
//#endregion FEngineExecutor

//#region FEngineData
message ScriptRequest {

}

message SelectRequest {
  repeated string fieldNames = 1;
  string filter = 2;
}

message InsertRequest {

}

message UpdateRequest {

}

message DeleteRequest {

}

enum LogicRelation {
  AND = 0;
  OR = 1;
}
//#endregion FEngineData
